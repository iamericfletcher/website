<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>CEO Departures</title>
    <!--==================== UNICONS ====================-->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v3.0.6/css/line.css">

    <!--==================== CSS ==========-->
    <link rel="stylesheet" href="../../../../css/styles.css">

    <!--ChartJS-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.5.1/dist/chart.min.js"></script>
</head>
<body>

<!--BEGIN CHART-->
<canvas id="chart" width="800" height="200"></canvas>

<script>

    chartIt();

    async function chartIt() {

        const data = await getData();

        const ctx = document.getElementById('chart').getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: data.years,
                datasets: [
                    {
                        label: 'Retired',
                        data: data.retired,
                        backgroundColor: [
                            'rgba(255, 202, 58, 0.2)',
                        ],
                        borderColor: [
                            'rgba(255, 202, 58, 1)',
                        ],
                        borderWidth: 1
                    },
                    {
                        label: 'Died While in Office',
                        data: data.died,
                        backgroundColor: [
                            'rgba(255, 89, 94, 0.2)',
                        ],
                        borderColor: [
                            'rgba(255, 89, 94, 1)',
                        ],
                        borderWidth: 1
                    },
                    {
                        label: 'New Opportunity',
                        data: data.newOpportunity,
                        backgroundColor: [
                            'rgba(138, 201, 38, 0.2)',
                        ],
                        borderColor: [
                            'rgba(138, 201, 38, 1)',
                        ],
                        borderWidth: 1
                    },
                    {
                        label: 'Performance',
                        data: data.performance,
                        backgroundColor: [
                            'rgba(25, 130, 196, 0.2)',
                        ],
                        borderColor: [
                            'rgba(25, 130, 196, 1)',
                        ],
                        borderWidth: 1
                    },
                    {
                        label: 'Illness',
                        data: data.illness,
                        backgroundColor: [
                            'rgba(106, 76, 147, 0.2)',
                        ],
                        borderColor: [
                            'rgba(106, 76, 147, 1)',
                        ],
                        borderWidth: 1
                    },
                    {
                        label: 'Legal',
                        data: data.legal,
                        backgroundColor: [
                            'rgba(94, 48, 35, 0.2)',
                        ],
                        borderColor: [
                            'rgba(94, 48, 35, 1)',
                        ],
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Number of CEOs'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Year'
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: 'CEO Departure in S&P 1500 Firms From 1990 Through 2020'
                    },
                    legend: {
                        position: 'right',
                        title: {
                            display: true,
                            text: 'Departure Type'
                        }
                    },
                },
                interaction: {
                    intersect: false,
                    mode: 'nearest'
                }
            }
        })
    }

    async function getData() {

        const response = await fetch('departures-wide.csv');
        const data = await response.text();
        const years = [];
        const retired = [];
        const died = [];
        const newOpportunity = [];
        const performance = [];
        const illness = [];
        const legal = [];


        const table = data.split('\n');

        table.forEach(row => {

            const columns = row.split(',');
            const eventFiscalYear = columns[0];

            // remove the column name from x-axis
            if (eventFiscalYear !== 'fyear') {
                years.push(columns[0]);
                retired.push(columns[1]);
                died.push(columns[2]);
                newOpportunity.push(columns[3]);
                performance.push(columns[5]);
                illness.push(columns[6])
                legal.push(columns[7])
            }

        });

        return {years, retired, died, newOpportunity, performance, illness, legal};

    }


</script>

<!--END CHART-->

<section class="stuff section" id="stuff">

    <h1 class="section__title">Notes</h1>

    <div class="container">

        <p class="stuff__notes">

            <a href="https://www.youtube.com/c/TheCodingTrain/featured" target="_blank">The Coding Train</a> YouTube
            channel is full of creative coding video tutorials.
            Their <a href="https://www.youtube.com/playlist?list=PLRqwX-V7Uu6YxDKpFzf_2D84p0cyk4T7X" target="_blank">Working
            with Data and APIs in JavaScript</a>
            series inspired me to use <strong>HTML</strong>-based <strong>JavaScript</strong> charts. In the past, I
            have used the
            <a href="https://www.r-project.org/about.html" target="_blank">R programming language</a> to perform
            statistical analysis and data visualization. While
            <strong>R</strong> is making significant progress in the web development space, nothing beats using <strong>HTML</strong>,
            <strong>CSS</strong>,
            and <strong>JavaScript</strong>.
            <br>
            <br>
            In this example, I used all four languages! First, I cleaned up the data using <strong>R</strong>. Then, I
            used
            the <a href="https://www.chartjs.org/" target="_blank">Chart.js</a> <strong>JavaScript</strong> library to
            produce the visualization. Finally,
            thanks to <strong>HTML</strong> and <strong>CSS</strong>, you're able to view this post within your browsers
            window!
            <br>
            <br>
            I accessed the data to make the above line chart via the <a
                href="https://github.com/rfordatascience/tidytuesday" target="_blank">TidyTuesday</a>
            community of practice, a weekly data project aimed at the <strong>R</strong> programming ecosystem. You can
            learn more about the dataset
            and the authors <a
                href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2021/2021-04-27/readme.md"
                target="_blank">here</a>.
            <br>
            <br>
            Please note that you can add or remove departure types by clicking the type(s) in the legend located on the
            right side of the chart.
            <br>
            <br>
            Thanks for stopping by!
            <br>
            <br>
            Until next time,
            <br>
            <br>
            Eric

        </p>


    </div>

</section>

</body>
</html>